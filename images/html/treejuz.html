<!DOCTYPE html>
<html lang="zh-CN">

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
		<title>Bootstrap 101 Template</title>

		<!-- Bootstrap -->
		<link href="css/bootstrap.min.css" rel="stylesheet">

		<!-- HTML5 shim 和 Respond.js 是为了让 IE8 支持 HTML5 元素和媒体查询（media queries）功能 -->
		<!-- 警告：通过 file:// 协议（就是直接将 html 页面拖拽到浏览器中）访问页面时 Respond.js 不起作用 -->
		<!--[if lt IE 9]>
      <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
	</head>
	<style type="text/css">
		* {
			margin: 0;
			padding: 0;
		}
		
		.row1 {
			width: 100%;
			border: #ccc solid 0px;
			margin-left: 10px;
			margin-right: 0;
			margin-top: 30px;
			animation: 3s sq;
		}
		
		@keyframes sq {
			from {
				opacity:0
			}
			to {
				opacity:1
			}
		}
		
		.row {
			border: 0;
			width: 0%;
		}
		
		.touxiang {
			width: 40px;
			height: 40px;
			background-image: url("1.jpg");
			background-size: 100%;
			float: left;
		}
		
		.kuang {
			
			background: #fff;
			border: #fccc solid 0.18rem;
			float: left;
			margin-left: 48px;
			margin-top: -20px;
			border-radius: 4px;
			text-align: center;
			line-height: 15px;
			padding: 8px 8px 0px 8px;
			white-space:nowrap;
			font-size: 14px;
			letter-spacing:1px
		}
		
		.kuang:after {
			position: relative;
			left: -18px;
			top: -14px;
			float: left;
			display: block;
			content: '';
			border: 5px solid transparent;
			border-right-color: #fff;
			transform: rotate(0deg);
			border-radius: 0%;
		}
		
		.name {
			width: 100%;
			height: 20px;
			float: left;
			margin-left: 46px;
			margin-top: 3px;
			color: #adadad;
			text-align: center;
			white-space:nowrap;
			font-size: 14px;
		}
		
		.dibu {
			width: 100%;
			height: 50px;
			margin-left: 0;
			margin-bottom: 0;
			position: fixed;
			bottom: 0;
			background: #f4f4f4;
			border: 0;
			border-top: 1px solid #d8d8d8;
			z-index: 2;
		}
		
		.tubiao1 {
			width: 34px;
			height: 34px;
			position: fixed;
			left: 14px;
			bottom: 7px;
			border: 1px solid #6e7176;
			border-radius: 50%;
			background-image: url("t1.png");
			background-size: 100%;
			float: left;
		}
		
		.tubiao2 {
			width: 34px;
			height: 34px;
			position: fixed;
			right: 14px;
			bottom: 7px;
			border: 1px solid #6e7176;
			border-radius: 50%;
			background-image: url("t3.png");
			background-size: 100%;
			float: right;
			text-align: center;
			line-height: 34px;
			color: #fffaff;
		}
		
		.tubiao3 {
			width: 34px;
			height: 34px;
			position: fixed;
			right: 60px;
			bottom: 7px;
			border: 1px solid #6e7176;
			border-radius: 50%;
			background-image: url("t2.png");
			background-size: 100%;
			float: right;
		}
		
		.an {
			border: 0;
			border-bottom: #d8d8d8 solid 1px;
			width: 59%;
			line-height: 35px;
			position: fixed;
			left: 50px;
			padding: 3px;
			height: 35px;
			bottom: 7px;
			padding: 5px 5px 0px 8px;
			text-shadow: 0px 0px 0px #000;
			-webkit-text-fill-color: transparent;
			background: transparent;
		}
		
		.an:focus {
			border-bottom-color: #68a351;
			outline: 0;
			color: #68a351;
		}
		
		#time {
			width: 50px;
			height: 18px;
			background: rgba(212, 212, 212, 0.5);
			border-radius: 2px;
			color: #fff;
			text-align: center;
			line-height: 18px;
			position: absolute;
			left: 50%;
			margin-left: -25px;
			top: 25px
		}
		
		.music {
			width: 28px;
			height: 28px;
			background: #a0e75a;
			border: 1px solid #74be50;
			border-radius: 50%;
			position: fixed;
			top: 100px;
			float: right;
			right: 10px;
			color: #f5f5f5;
			font-size: 9px;
			text-align: center;
			padding-right: 2px;
			line-height: 26px;
			cursor: pointer;
		}
		
		.music.rotate {
			-webkit-animation: rot 10s linear infinite;
			-moz-animation: rot 10s linear infinite;
			-ms-animation: rot 10s linear infinite;
			-o-animation: rot 10s linear infinite;
			animation: rot 10s linear infinite;
		}
		
		@keyframes rot {
			from {
				transform: rotate(0deg);
			}
			to {
				transform: rotate(360deg);
			}
		}
		.row2{
			width: 100%;
			border: #ccc solid 0px;
			clear: both;
			margin-top: 30px;
			animation: 3s sq;
		}
		.touxianga{
			width: 40px;
			height: 40px;
			background-image: url("1.jpg");
			background-size: 100%;
			float: right;
			margin-right: 10px;
			
		}
		
		.kuanga{
			background: #fff;
			border: #fccc solid 0.18rem;
			float: right;
			margin-right:8px;
			margin-top: 5px;
			border-radius: 4px;
			text-align: center;
			line-height: 30px;
			padding: 4px 8px 0px 8px;
			white-space:nowrap;
			font-size: 14px;
			letter-spacing:1px;
			
		}
		
		.touxianga:after {
			position: relative;
			left: -8px;
			top: 18px;
			float: left;
			display: block;
			content: '';
			border: 5px solid transparent;
			border-right-color: #fff;
			transform: rotate(180deg);
			border-radius: 0%;
			
		}
		
	</style>
	<body style="background: #ebebeb; backface-visibility: hidden;font-family:  src: url("小米兰亭.ttf")">
  	<div id="time">00:00</div>
  	<div class="music glyphicon glyphicon-music rotate" id="music">
  		<audio id="musics" src="music.mp3 " autoplay="autoplay " ></audio>
  	</div>
  	<div class="row row1" style="height:5px;"></div>
		<div class="row row1">
			<div class="touxiang"><span class="name">simle</span></div>
			<div class="kuang">??</div>
		</div>
		
		
		<div class="row3" id="left" style="margin-left: 0px;">
			
		<div class="row row2">
			<div class="touxianga"></div>
			<div class="kuanga">1212</div>
		</div>
		
		</div>
		<div class="row" style="height:60px; width: 100%;"></div>
		
		<div class="row dibu">
			<div class="tubiao1"></div>
			<input type="text" class="an" id="input" >
			<div class="tubiao2" id="tubiao2"></div>
			<div class="tubiao3"></div>
		</div>
		<div id="con" style="display: none;">
			
		</div>
		<div id="translate" style="display: none;"></div>
    <!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
    <script src="jquery.min.js "></script>
    <!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
    <script src="js/bootstrap.min.js "></script>
    <script src="./md5.js"></script>
<script type="text/javascript">//百度翻译api
var translate = document.getElementById("translate");
var Input = document.getElementById("input");

//console.log(ss.success)

</script>
    
    
    <script>
window.onload=function (){
    	var Input = document.getElementById("input");
    	var tubiao = document.getElementById("tubiao2");
    	var music = document.getElementById("music");
    	 	var left = document.getElementById("left");
    	 	var row2 = document.getElementById("row2")
    		var ww = window.innerWidth
		var shart = 0
	
    	

    	var ts = tubiao.style
    	Input.onkeyup = function(){
    		d()
    	}
    	tubiao.onclick = function(){//发送文字
    		if(shart == 1 ){
    			
    			
    			
    			
    			
    			
    			
    			
    			
    			
    			
var appid = '20180829000199975';
var key = 'oXn_kcTj3vB10FImOgCL';
var salt = (new Date).getTime();
var query = Input.value;
// 多个query可以用\n连接  如 query='apple\norange\nbanana\npear'
var from = 'auto';
var to = 'en';
var str1 = appid + query + salt +key;
var sign = MD5(str1);
var ss= $.ajax({
    url: 'http://api.fanyi.baidu.com/api/trans/vip/translate',
    type: 'get',
    dataType: 'jsonp',
    data: {
        q: query,
        appid: appid,
        salt: salt,
        from: from,
        to: to,
        sign: sign
    },
    success: function (data) {
        //console.log(data);
        //console.log(data.trans_result[0].dst);
        //console.log(data.trans_result[0].src);
         deta = data.trans_result[0].dst;
        var pos = 0
        var currentStr =""
        
        var fragments = document.createDocumentFragment();//节点片段
			var oBalloons  =document.createElement('div')//创建div标签
			var tss = Input.value;
			var translate = document.getElementById("translate");
			
			tss =deta
			oBalloons.className = 'row row2';
			var length = tss.length
			
            
			
			oBalloons.innerHTML = "<div class='touxianga'></div><div class='kuanga'>"+tss+"</div>"
			fragments.appendChild(oBalloons);//放到body里面去
			left.appendChild(fragments);
	        Input.value=""
	        scrollToEnd()
        	function scrollToEnd(){//滚动到底部
            var h = $(document).height()-$(window).height();
            $(document).scrollTop(h);
           		}
        
        
        
    } 
    
});
    			
    			
    			
    			
    			
    			
    			
    		
    			
    			}
    		
    			
    		
    	}
    	function d(){//发生文字
	    		if(Input.value == "")
	    	{
	    		ts.width="34px";
	    		ts.height="34px";
	    		ts.borderRadius = "50%";
	    		ts.border="1px solid #6e7176";
	    		tubiao.innerHTML =""
	    		ts.background=""
	    		ts.backgroundImage="url(t3.png)";
	    		ts.right="14px";
	    		 shart = 0
	    	}else{
	    		ts.right="8px";
	    		ts.width="46px";
	    		ts.height="34px";
	    		ts.background="#1aac19 ";
	    		ts.border="1px solid #199b1d ";
	    		ts.borderRadius ="4px";
	    		tubiao.innerHTML = "发送 ";
	    		shart = 1
	    	}
    	}
    	Times()//时间
    	function Times(){
    		Time = document.getElementById("time");
    		da = new Date();
    		var shi = da.getHours();//小时
    		var fen = da.getMinutes();//分钟
    		var sf = shi+":"+jo(fen);
    		Time.innerHTML = sf;
    	}
    function jo(a){
    	if(a<10){
    		 a = "0"+a
    	}else{
    		a = a
    	}
    	return a;
    }
		function play(){//开始播放
			$("#musics").get(0).play();
			$(".music").addClass("rotate")
		}
		switchMusic()
		function switchMusic(){
			var Music = $("#musics").get(0);
			music.onclick=function(){
				if(Music.paused){
	    		play()
	    	}else{
	    		pause()
	    	}
			}
		}
			function pause(){//停止播放
				$("#musics").get(0).pause();
				$(".music").removeClass("rotate");
			};
		
	}
    </script>
   <script>
   	var div2 = document.getElementById("music");
   	 var flag = false;
    var cur = {
        x:0,
        y:0
    }
    var nx,ny,dx,dy,x,y ;
    function down(){
        flag = true;
        var touch ;
        if(event.touches){
            touch = event.touches[0];
        }else {
            touch = event;
        }
        cur.x = touch.clientX;
        cur.y = touch.clientY;
        dx = div2.offsetLeft;
        dy = div2.offsetTop;
    }
    function move(){
        if(flag){
            var touch ;
            if(event.touches){
                touch = event.touches[0];
            }else {
                touch = event;
            }
            nx = touch.clientX - cur.x;
            ny = touch.clientY - cur.y;
            x = dx+nx;
            if(x>=window.innerWidth){
            	x= window.innerWidth-28
            }
            if(x<=0){
            	x= 0
            	
            }
            
            y = dy+ny;
            if(y>=window.innerHeight-78){
            	y= window.innerHeight-78
            }
            if(y<=0){
            	y= 0;
            	
            }
            div2.style.left = x+"px";
            
            div2.style.top = y +"px";
            //阻止页面的滑动默认事件
            document.addEventListener("touchmove",function(){
                event.preventDefault();
            },false);
        }
    }
    //鼠标释放时候的函数
    function end(){
        flag = false;
    }
    var div2 = document.getElementById("music");
    
    div2.addEventListener("mousedown",function(){
        down();
    },false);
    div2.addEventListener("touchstart",function(){
        down();
    },false)
    div2.addEventListener("mousemove",function(){
        move();
    },false);
    div2.addEventListener("touchmove",function(){
        move();
    },false)
    document.body.addEventListener("mouseup",function(){
        end();
    },false);
    div2.addEventListener("touchend",function(){
        end();
    },false);
    
    
    //var a ="http://music.163.com/api/song/media?id=29722582"
    //"https://lincaiqihtml.github.io/images/one.lrc"
   var a = ajaxGetHTML("https://lincaiqihtml.github.io/images/one.lrc")
function ajaxGetHTML(webURL) { 
            var url = webURL;  
            if (url == "") url = document.getElementById("xurl").value;  
            var xmlhttp;  
            try {  
                xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");  
            } catch(e) {  
                try {  
                    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");  
                } catch(e) {}  
            }  
            if (!xmlhttp) xmlhttp = new XMLHttpRequest();  
            xmlhttp.onreadystatechange = function() {  
                if (xmlhttp.readyState == 4) {  
                    var s = xmlhttp.responseText;
					s =s.replace(/<.*?>/g,"");  
                    s = s.replace(/</g, "<");  
                    s = s.replace(/>/g, ">"); 
					s = s.replace(/;/g, "<br>");
					s = s.replace(/[\r\n]/g, "<br/>"); 
					//console.log(s)
					
var lrc =s
var lrcarr = lrc.split("[");//从哪个字符开始，分隔成数组 // xx.length获取数组的成员

var html="";
var con = document.getElementsByClassName("content")[0];//通过class类名去获取元素 数组的形式储存  []
for( var i = 0; i < lrcarr.length;i++)
{
	var arr =lrcarr[i].split("]");//分割歌词与时间	把全部数组成员分割 字符 ]
	var time =arr[0].split(".") ;//分割分秒和毫秒
	var timer = time[0].split(":");//分割分和秒
	
	var ms = timer[0] * 60 + timer[1]*1;//分*60+秒*1=xx秒
	//字符串类型乘以数字类型就会转化成为数字类型
	var txtmusic =arr[1]//获取歌词部分；
	if(txtmusic){
	html +="<p id=" + ms + ">" + txtmusic +"</p>"+"</br>";
	
	}
	
	
}
var con = document.getElementById("con");
	con.innerHTML = html;
	var num = 0;
var left = document.getElementById("left");
var op = con.getElementsByTagName("p");//通过签名获取所有的p元素;
var ks = null 
var name = "simle"
$("#musics").get(0).addEventListener("timeupdate",function(){
		var scale = this.currentTime/this.duration;
		var currenttime=this.currentTime;
		var duration=this.duration;
		var bfms = parseInt(this.currentTime);//当前播放的时间为秒
		//console.log(op.length)
		if(document.getElementById(bfms)){
			var fragment = document.createDocumentFragment();//节点片段
			var oBalloon  =	document.createElement('div')//创建div标签
			var ms =document.getElementById(bfms).innerHTML
			//console.log(ks)
			if(ms!=ks){
				oBalloon.className = 'row row1';
			oBalloon.innerHTML = "<div class='touxiang'><span class='name'>"+name+"</span></div><div class='kuang'>"+ms+"</div>"
			fragment.appendChild(oBalloon);//放到body里面去
			left.appendChild(fragment);
			var a = document.documentElement.scrollTop==0? document.body.clientHeight : document.documentElement.clientHeight;
			var b = document.documentElement.scrollTop==0? document.body.scrollTop : document.documentElement.scrollTop;
			var c = document.documentElement.scrollTop==0? document.body.scrollHeight : document.documentElement.scrollHeight;
			if(a+b==c){
				
			}
			//scrollToEnd()
			
			
				scrollToEnd()
			
			
			function scrollToEnd(){//滚动到底部
            var h = $(document).height()-$(window).height();
            $(document).scrollTop(h);
           		}
			ks=ms
				
			}
			
			//var ms =document.getElementById(bfms)
			
			
		}

	});
	
	
	
	
	
                }  
            }  
            xmlhttp.open("GET", url, true);  
            xmlhttp.send(null);  
        }   
    
    
    	
   
    //获取歌词
   
</script>

</body>
</html>